schema {
  query: Query
  mutation: Mutation
  subscription: Subscription
}

type Query {
  me: User
}

type Mutation {
  login(email: String!): String
  playMove(gameId: ID!, avatar: Avatar!, position: Position!): Game!
}

type Subscription {
  moves(gameId: ID!): Move!
  game(gameId: ID!): Game!
  joinGame(userId: ID!): Game!
}

type User {
  id: ID!
  email: String!
}

interface GameDescriptor {
  id: ID!
  xPlayer: Player!
  oPlayer: Player!
  moves: [Move!]
}

union Game = GameOpen | GameOver | GameTie

type GameOpen implements GameDescriptor {
  id: ID!
  xPlayer: Player!
  oPlayer: Player!
  moves: [Move!]
  nextPlayer: Player!
}

type GameOver implements GameDescriptor {
  id: ID!
  xPlayer: Player!
  oPlayer: Player!
  moves: [Move!]
  winner: Player
}

type GameTie implements GameDescriptor {
  id: ID!
  xPlayer: Player!
  oPlayer: Player!
  moves: [Move!]
}

type Player {
  user: User!
  avatar: Avatar!
  games: [Game!]
}

type Move {
  position: Position!
  avatar: Avatar!
}

"""
The Os and Xs in tic-tac-toe
"""
enum Avatar {
  O
  X
}

"""
Represents a tic-tac-toe board, like this:

P0 P1 P2
P3 P4 P5
P6 P7 P8
"""
enum Position {
  P0
  P1
  P2
  P3
  P4
  P5
  P6
  P7
  P8
}
