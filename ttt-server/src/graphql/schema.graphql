type Mutation {
  join: JoinResult!
  register: RegisterResult!
  play(input: PlayInput!): Boolean!
}

type Query {
  users: [User!]!
  whoami: String
  ping: String!
  game(id: ID!): Game
  myGames: [Game!]!
}

type RegisterResult {
  accessToken: String!
  user: User!
}

type User {
  id: ID!
  tokenVersion: Int!
}

type JoinResult {
  gameId: ID!
  token: Token!
  next: Token!
}

input PlayInput {
  gameId: ID!
  token: Token!
  position: Position!
}

enum Token {
  O
  X
}

enum Position {
  A
  B
  C
  D
  E
  F
  G
  H
  I
}

type Game {
  id: String!
  state: GameState!
}

union GameState = GamePlaying | GameDraw | GameWon

type GamePlaying {
  next: Token!
}

type GameDraw {
  # hack to allow an empty type in an union with
  # an optional value that'll be never be sent
  empty: Boolean
}

type GameWon {
  winner: Token!
}
